<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Upload Form</title>
    <link rel="stylesheet" href="login.css">
</head>
<body>

<div class="content">
    <form name="f" method="post" action="/process_login" style="color: #B9B4C7">
        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
        <h1>Проблема  </h1>
        <div class="continue">
        <div class="upLine">
<div class="inputs">
        <div class="container">
            <label for="title" class="form-label">Заголовок: </label>
            <input type="text" name="username" id="title" class="form-input">
        </div>

        <div class="container">
            <label for="region" class="form-label">Регион </label>
            <select name="region" id="region" class="form-input">
                <option value="region1">Регион 1</option>
                <option value="region2">Регион 2</option>
                <option value="region3">Регион 3</option>
            </select>
        </div>
        <div class="container">
            <label for="message">Сообщение</label>
            <textarea id="message" name="message" rows="4" required></textarea>
        </div>
        </div>
<!--            место для карты -->
            <div class="map"></div>
        </div>
        <div class="bottunCont">
            <form method="post" enctype="multipart/form-data">
                <div class="input-file-row">
                    <label class="input-file">
                        <input type="file" name="photo1" id="photo1" multiple>
                        <span>Выберите файл</span>
                    </label>
                    <div class="input-file-list"></div>
                </div>
            </form>

            <form method="post" enctype="multipart/form-data">
                <div class="input-file-row">
                    <label class="input-file">
                        <input type="file" name="photo2" id="photo2" multiple>
                        <span>Выберите файл</span>
                    </label>
                    <div class="input-file-list"></div>
                </div>
            </form>

            <form method="post" enctype="multipart/form-data">
                <div class="input-file-row">
                    <label class="input-file">
                        <input type="file" name="photo3" id="photo3" multiple>
                        <span>Выберите файл</span>
                    </label>
                    <div class="input-file-list"></div>
                </div>
            </form>

            <form method="post" enctype="multipart/form-data">
                <div class="input-file-row">
                    <label class="input-file">
                        <input type="file" name="photo4" id="photo4" multiple>
                        <span>Выберите файл</span>
                    </label>
                    <div class="input-file-list"></div>
                </div>
            </form>

        </div>

        <div class="login-button">
            <input type="submit" value="Создать" class="log">
        </div>

        <div if="${param.error}" style="color: red" >
                ошибка
        </div>
        </div>
    </form>


    <script>

        var dt = new DataTransfer();

        $('.input-file input[type=file]').on('change', function(){
            let $files_list = $(this).closest('.input-file').next();
            $files_list.empty();

            for(var i = 0; i < this.files.length; i++){
                let new_file_input = '<div class="input-file-list-item">' +
                    '<span class="input-file-list-name">' + this.files.item(i).name + '</span>' +
                    '<a href="#" onclick="removeFilesItem(this); return false;" class="input-file-list-remove">x</a>' +
                    '</div>';
                $files_list.append(new_file_input);
                dt.items.add(this.files.item(i));
            };
            this.files = dt.files;
        });

        function removeFilesItem(target){
            let name = $(target).prev().text();
            let input = $(target).closest('.input-file-row').find('input[type=file]');
            $(target).closest('.input-file-list-item').remove();
            for(let i = 0; i < dt.items.length; i++){
                if(name === dt.items[i].getAsFile().name){
                    dt.items.remove(i);
                }
            }
            input[0].files = dt.files;
        }
    </script>
</div>

</body>
</html>
